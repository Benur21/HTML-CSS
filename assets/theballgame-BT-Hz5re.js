var $=Object.defineProperty;var V=(n,l,e)=>l in n?$(n,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[l]=e;var a=(n,l,e)=>V(n,typeof l!="symbol"?l+"":l,e);import{e as u,g as v,b as q,d as F,r as W,R,L as y,a as K,t as U,c as m,A as N}from"./JSTools-B8p_a33K.js";function O(n){const l=window.globals.canvas;switch(n){case"en":document.cookie="language="+n+"; expires=Thu, 01 Jan 2040 00:00:00 UTC; path=/;",document.title="The Ball Game",l.innerHTML="Your browser doesn't support the HTML5 canvas tag.",u("backToIndex").innerHTML="Back",u("reloadButton").innerHTML="Reload",u("downloadGame").innerHTML="Download Game (Portuguese only)",window.globals.livesText_lang="Lives",window.globals.scoreText_lang="Score",window.globals.playGameOption_lang="Play",window.globals.optionsOption_lang="Options",window.globals.downloadOption_lang="Download",window.globals.optionsSoon_lang="Soon",window.globals.backToMenu_lang="Exit",window.globals.exitOptionsButton_lang="Back to Main Menu";break;default:localStorage.removeItem("language"),document.cookie="language=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.title="Jogo da Bolinha",l.innerHTML="O teu browser nÃ£o suporta a tag canvas do HTML5.",u("backToIndex").innerHTML="Voltar",u("reloadButton").innerHTML="Recarregar",u("downloadGame").innerHTML="Descarregar Jogo",window.globals.livesText_lang="Vidas",window.globals.scoreText_lang="PontuaÃ§Ã£o",window.globals.playGameOption_lang="Jogar",window.globals.optionsOption_lang="OpÃ§Ãµes",window.globals.downloadOption_lang="Descarregar",window.globals.optionsSoon_lang="Brevemente",window.globals.backToMenu_lang="Sair",window.globals.exitOptionsButton_lang="Voltar para o Menu Principal";break}}var k=u("dropdownLanguage");v("language")!=null&&v("language")!=""?k.value=v("language"):k.value="pt";const S=u("canvas");if(S==null)throw new Error("Canvas is null.");window.globals.canvas=S;const T=u("background");document.body.onresize=L;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{L(),O(v("language"))}):(L(),O(v("language")));u("backToIndex").onclick=q;u("reloadButton").onclick=()=>location.reload(!0);u("downloadGame").onclick=()=>F("https://www.dropbox.com/s/0stlwtfyvryq57w/Jogo%20da%20Bolinha.rar?dl=1");k.onchange=()=>O(k.value);const J=S.getContext("2d");if(J==null)throw new Error("Canvas context is null.");const G=u("toolBar");G&&(G.style.height=window.globals.toolBarHeight+"px");S.style.top=window.globals.toolBarHeight+"px";T.style.width=innerWidth+"px";T.style.height=innerHeight+"px";J.lineJoin="round";var _=new Audio("resources/Click.wav"),Q=new Audio("resources/BellRing.wav");W();const C=window.globals.canvas;var d,H=!1,D=!1,M=!1,P=!1;document.body.onkeydown=function(n){d=n.which||n.keyCode||n.code,(d===38||d===87)&&(H=!0),(d===37||d===65)&&(D=!0),(d===39||d===68)&&(M=!0),(d===40||d===83)&&(P=!0)};document.body.onkeyup=function(n){d=n.which||n.keyCode||n.code,(d===38||d===87)&&(H=!1),(d===37||d===65)&&(D=!1),(d===39||d===68)&&(M=!1),(d===40||d===83)&&(P=!1)};var B,X,I;document.body.onmousemove=function(n){const l=C.getBoundingClientRect(),e=n.clientX-l.left,s=n.clientY-l.top;B=e*(C.width/l.width),X=s*(C.height/l.height)};document.body.onmousedown=function(){I=!0};document.body.onmouseup=function(){I=!1};document.body.onresize=L;function L(){W(),T.style.width=innerWidth+"px",T.style.height=innerHeight+"px"}function z(n){typeof n.upIsDown=="boolean"&&(H=n.upIsDown),typeof n.leftIsDown=="boolean"&&(D=n.leftIsDown),typeof n.rightIsDown=="boolean"&&(M=n.rightIsDown),typeof n.downIsDown=="boolean"&&(P=n.downIsDown)}const g=window.globals.canvas,w=window.globals.canvas.getContext("2d");class p extends y{constructor(e,s,o,i,r,f){super(e,s,o,i);a(this,"hoveringHeightIncrement");a(this,"onclick");a(this,"internal_hovered");a(this,"internal_waitingForRelease");a(this,"internal_mouseEnter");a(this,"internal_mouseLeave");this.outlineWidth=8,this.textHeight=r,this.hoveringHeightIncrement=f,this.onclick,this.internal_hovered=!1,this.internal_waitingForRelease=!1,this.internal_mouseEnter=!1,this.internal_mouseLeave=!0}onhover(){if(!this.isFocused())return;let e=B,s=X;try{const b=w.getTransform();b.invertSelf();const j=new DOMPoint(B,X).matrixTransform(b);e=j.x,s=j.y}catch(b){console.warn("Could not invert canvas transform for mouse hit-testing.",b)}let o,i,r,f;this.xAlign=="center"?(o=e>this.x-w.measureText(this.text).width/2-this.hoveringHeightIncrement,i=e<this.x+w.measureText(this.text).width/2+this.hoveringHeightIncrement,r=s>this.y-this.textHeight/2-this.hoveringHeightIncrement,f=s<this.y+this.textHeight/2+this.hoveringHeightIncrement):this.xAlign=="start"?(o=e>this.x-this.hoveringHeightIncrement,i=e<this.x+w.measureText(this.text).width+this.hoveringHeightIncrement,r=s>this.y-this.textHeight/2-this.hoveringHeightIncrement,f=s<this.y+this.textHeight/2+this.hoveringHeightIncrement):console.error("Invalid xAlign value on TextButton."),this.internal_hovered=o&&i&&r&&f,this.internal_hovered?(this.internal_mouseEnter||(this.internal_mouseEnter=!0,this.textHeight+=this.hoveringHeightIncrement),this.internal_mouseLeave=!1,this.outlineColor="black"):(this.internal_mouseLeave||(this.internal_mouseLeave=!0,this.textHeight-=this.hoveringHeightIncrement),this.internal_mouseEnter=!1,this.internal_waitingForRelease=!1,this.outlineColor=U)}onClickEvent(){this.isFocused()&&this.internal_hovered&&(I&&(this.internal_waitingForRelease=!0),!I&&this.internal_waitingForRelease&&(this.onclick&&this.onclick(),this.internal_waitingForRelease=!1))}updateLanguage(){this.text="<!ERROR!>"}update(){this.updateContext(),this.onhover(),this.onClickEvent(),this.updateLanguage()}isFocused(){if(this.parent instanceof x)return this.parent.isTopWindow();if(this.parent instanceof Y){const e=x.getAllInstances();for(let s=0;s<e.length;s++)if(e[s].visible)return!1;return!0}else return!0}}class E extends y{constructor(e,s,o,i,r){super(e,s,"",i);a(this,"type");a(this,"count");switch(this.type=o,this.count=r,this.type.toLowerCase()){case"lives":this.text=window.globals.livesText_lang;break;case"score":this.text=window.globals.scoreText_lang;break}}}class A extends K{constructor(e,s){super(e,s,15);a(this,"speedX",0);a(this,"speedY",0);a(this,"color","#0000FF");a(this,"walkSpeed",2);a(this,"jumpSpeed",20);a(this,"side","left");a(this,"touchingLava",!1);a(this,"delaying",!1);a(this,"delayed",0);a(this,"finalDelayTime",0);a(this,"lives");a(this,"score");a(this,"initX");a(this,"initY");a(this,"visible",!0);this.initX=e,this.initY=s,this.lives=new E(10,40,"lives","start",5),this.score=new E(10,80,"score","start",0)}drawText(){this.lives.text=window.globals.livesText_lang+" = "+this.lives.count,this.lives.updateContext(),this.lives.draw(),this.score.text=window.globals.scoreText_lang+" = "+this.score.count,this.score.updateContext(),this.score.draw()}updateX(){this.delaying||(this.speedX*=.7,D&&this.x>this.radius&&(this.speedX-=this.walkSpeed),M&&this.x<t.width-this.radius&&(this.speedX+=this.walkSpeed),this.x+=this.speedX,this.x<this.radius&&(this.speedX<0&&_.play(),this.speedX=0,this.x=this.radius),this.x>t.width-this.radius&&(this.speedX>0&&_.play(),this.speedX=0,this.x=t.width-this.radius))}updateY(){this.delaying||(this.speedY===1&&this.y>t.height-this.radius-1&&H&&(this.speedY=-this.jumpSpeed),P&&(this.speedY+=1),this.y+=this.speedY,this.y>t.height-this.radius&&(this.speedY>10&&_.play(),this.speedY=0,this.y=t.height-this.radius),this.speedY++,this.y<this.radius&&(this.speedY<-10&&_.play(),this.speedY=0,this.y=this.radius))}checkPos(){if(!this.delaying){const e=t.container.lava;this.y>e.y-this.radius&&this.x>e.x-this.radius+5&&this.x<e.x+e.width+5&&(this.speedX=0,this.speedY=0,this.y=e.y-this.radius,this.touchingLava=!0),this.x>e.x-this.radius&&this.y>e.y-this.radius&&this.x<e.x+e.width/2&&(this.speedX=0,this.x=e.x-this.radius,this.touchingLava=!0),this.x>e.x+e.width/2&&this.y>e.y-this.radius&&this.x<e.x+e.width+this.radius&&(this.speedX=0,this.x=e.x+e.width+this.radius,this.touchingLava=!0),(this.touchingLava||this.delayed>0)&&(this.touchingLava=!1,this.delayed===0&&this.delay(100),!this.delaying&&this.delayed===1&&(Q.play(),this.delay(650)),!this.delaying&&this.delayed===2&&(this.lives.count--,this.delay(650)),!this.delaying&&this.delayed>=2&&(this.side="left",this.x=100+this.radius,this.y=t.height/2+this.radius,this.speedX=0,this.speedY=5,this.delayed=0,this.lives.count<=0&&(alert(`Perdeste com ${this.score.count} Ponto${this.score.count===1?"":"s"}!!`),this.score.count=0,this.lives.count=5,z({upIsDown:!1,rightIsDown:!1,leftIsDown:!1})))),this.side==="left"&&this.x>t.width/2&&this.y>t.height-this.radius-2&&(this.side="right",this.score.count++),this.side==="right"&&this.x<t.width/2&&this.y>t.height-this.radius-2&&(this.side="left",this.score.count++)}}updatePos(){this.updateX(),this.updateY()}delay(e){this.finalDelayTime=Date.now()+e,this.delaying=!0,this.delayed++}delayStop(){this.delaying&&Date.now()>this.finalDelayTime&&(this.delaying=!1,this.finalDelayTime=0)}restart(){this.x=this.initX,this.y=this.initY,this.walkSpeed=2,this.jumpSpeed=20,this.lives.count=5,this.score.count=0,this.side="left",this.touchingLava=!1,this.delaying=!1,this.delayed=0,this.finalDelayTime=0,this.speedX=0,this.speedY=0,this.visible=!0}}class Y extends R{constructor(){super(g.width/2-500,g.height/2-300,1e3,600);a(this,"container");this.outlinePosition="outer",this.color="#2f538e",this.visible=!1,this.container=new Proxy({},{set:(e,s,o)=>{if(e[s]=o,o&&typeof o=="object"&&"parent"in o)try{o.parent=this}catch{}return!0}})}draw(){if(w.setTransform(1,0,0,1,0,0),super.draw(),this.visible){var e=this.container.getAllProperties(),s=[],o=[];for(let i=0;i<e.length;i++)typeof e[i]=="object"&&typeof e[i].showIndex=="number"&&(s.push(i),o.push(e[i]));o.sort((i,r)=>i.showIndex-r.showIndex);for(let i=0;i<o.length;i++)e[s[i]]=o[i];w.save(),w.translate(this.x,this.y);for(let i=0;i<e.length;i++)switch(typeof e[i]){case"object":e[i]instanceof p?(e[i].update(),e[i].draw()):e[i]instanceof y?(e[i].updateLanguage(),e[i].updateContext(),e[i].draw()):e[i]instanceof x?(e[i].draw(),e[i].updatePos()):e[i]instanceof A?(e[i].drawText(),e[i].checkPos(),e[i].draw(),e[i].updatePos(),e[i].delayStop()):e[i].draw();break;case"function":e[i].toString().includes("getAllInstances")||e[i].toString().includes("getAllProperties")||e[i]();break}w.restore()}}}class x extends R{constructor(e,s){super(g.width/2-e/2,-s,e,s);a(this,"maxYMoveSpeed");a(this,"showing");a(this,"hiding");a(this,"container");a(this,"parent");this.color="#1062e8",this.outlinePosition="inner",this.maxYMoveSpeed=40,this.showing=!1,this.hiding=!1,this.container=new Proxy({},{set:(o,i,r)=>{if(o[i]=r,r&&typeof r=="object"&&"parent"in r)try{r.parent=this}catch{}return!0}}),this.parent=void 0}draw(){if(super.draw(),this.visible){var e=this.container.getAllProperties(),s=[],o=[];for(let i=0;i<e.length;i++)typeof e[i]=="object"&&typeof e[i].showIndex=="number"&&(s.push(i),o.push(e[i]));o.sort(function(i,r){return r.showIndex-i.showIndex});for(let i=0;i<o.length;i++)e[s[i]]=o[i];w.save(),w.translate(this.x,this.y);for(let i=0;i<e.length;i++)switch(typeof e[i]){case"object":e[i]instanceof p?(e[i].update(),e[i].draw()):e[i]instanceof y?(e[i].updateLanguage(),e[i].updateContext(),e[i].draw()):e[i]instanceof A?(e[i].drawText(),e[i].checkPos(),e[i].draw(),e[i].updatePos(),e[i].delayStop()):e[i].draw();break;case"function":e[i].toString().includes("getAllInstances")||e[i].toString().includes("getAllProperties")||e[i]();break}w.restore()}}updatePos(){const e=this.parent?-this.parent.y+g.height/2-this.height/2:g.height/2-this.height/2,s=this.parent?-this.parent.y-this.height:-this.height,o=this.parent?-this.parent.y+g.height:g.height,i=m(0,this.y,0,e)/m(0,s,0,e),r=m(0,this.y,0,o)/m(0,e,0,o);this.showing&&(this.visible=!0,this.y+=this.maxYMoveSpeed*i,Math.round(this.y)===Math.round(e)&&(this.showing=!1)),this.hiding&&(this.y+=this.maxYMoveSpeed*(1-r)+1,this.y>o&&(this.hiding=!1,this.visible=!1))}show(){this.x=this.parent?-this.parent.x+g.width/2-this.width/2:g.width/2-this.width/2,this.y=this.parent?-this.parent.y-this.height:-this.height,this.showing=!0,this.hiding=!1}hide(){this.x=this.parent?-this.parent.x+g.width/2-this.width/2:g.width/2-this.width/2,this.y=this.parent?-this.parent.y+g.height/2-this.height/2:g.height/2-this.height/2,this.showing=!1,this.hiding=!0}isTopWindow(){const e=x.getAllInstances();let s=null,o=-1/0;for(let i=0;i<e.length;i++)e[i].visible&&e[i].showIndex>o&&(o=e[i].showIndex,s=e[i]);return s===this}}window.globals.canvas.getContext("2d");var t=new Y,h=new Y,c=new Y;h.visible=!0;t.container.player=new A(115,t.height/2+15);t.container.lava=new R(t.width/2-50,t.height-130,100,130);t.container.lava.doPattern="diagonals";t.container.lava.color="orange";t.container.lava.outlineColor="red";t.container.lava.outlineWidth=2;t.container.lava.outlinePosition="inner";t.container.backToMenu_opt=new p(t.width/2,50,window.globals.backToMenu_lang,"center",40,5);t.container.backToMenu_opt.updateLanguage=function(){this.text=window.globals.backToMenu_lang};h.container.playGame_opt=new p(t.width/2,130,window.globals.playGameOption_lang,"center",50,5);h.container.playGame_opt.updateLanguage=function(){this.text=window.globals.playGameOption_lang};h.container.options_opt=new p(t.width/2,220,window.globals.optionsOption_lang,"center",50,5);h.container.options_opt.updateLanguage=function(){this.text=window.globals.optionsOption_lang};h.container.download_opt=new p(t.width/2,310,window.globals.downloadOption_lang,"center",50,5);h.container.download_opt.updateLanguage=function(){this.text=window.globals.downloadOption_lang};c.container.exitOptions_opt=new p(30,30,window.globals.exitOptionsButton_lang,"start",30,5);c.container.exitOptions_opt.updateLanguage=function(){this.text=window.globals.exitOptionsButton_lang};c.container.optionsSoon=new y(t.width/2,t.height/2-15,window.globals.optionsSoon_lang,"center");c.container.optionsSoon.textHeight=100;c.container.optionsSoon.updateLanguage=function(){this.text=window.globals.optionsSoon_lang};t.container.backToMenu_opt.onclick=function(){t.visible=!1,h.visible=!0,c.visible=!1},h.container.playGame_opt.onclick=function(){t.visible=!0,h.visible=!1,c.visible=!1,t.container.player.restart()},h.container.options_opt.onclick=function(){t.visible=!1,h.visible=!1,c.visible=!0},h.container.download_opt.onclick=function(){F("https://www.dropbox.com/s/0stlwtfyvryq57w/Jogo%20da%20Bolinha.rar?dl=1")},c.container.exitOptions_opt.onclick=function(){t.visible=!1,h.visible=!0,c.visible=!1};h.container.w=new x(700,500);h.container.w.container.closeButton=new p(680,20,"X","center",20,5);h.container.w.container.closeButton.updateLanguage=function(){this.text="X"};h.container.w.container.closeButton.onclick=()=>{h.container.w.hide()};h.container.w.container.welcomemsg=new y(350,250,"Welcome! ðŸ˜€","center");h.container.w.container.welcomemsg.updateLanguage=function(){this.text="Welcome! ðŸ˜€"};h.container.w.visible=!0;h.container.w.show();window.globals.mainMenu=h;N(function(){t.draw(),h.draw(),c.draw(),Z()});function Z(){document.hasFocus()||z({upIsDown:!1,leftIsDown:!1,rightIsDown:!1}),new Date().getTime()}
//# sourceMappingURL=theballgame-BT-Hz5re.js.map
